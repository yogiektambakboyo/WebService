<!DOCTYPE html><html lang="en">    <head>        <meta charset="utf-8">        <title>Detail Transfer Barang</title>        <meta name="viewport" content="width=device-width, initial-scale=1.0">        <meta name="description" content="">        <meta name="author" content="">        <?php        $this->load->view('include/header');        ?>		 <style>			.ui-autocomplete {			max-height: 200px;			overflow-y: auto;			/* prevent horizontal scrollbar */			overflow-x: hidden;			}			/* IE 6 doesn't support max-height			* we use height instead, but this forces the menu to always be this tall			*/			* html .ui-autocomplete {			height: 200px;			}		</style>    </head>    <body>        <div class="container">            <div class="row">                <div class="span12 center">                    <h1>Detail Transfer Barang</h1>                    <hr />                    <?php                    if ($this->session->flashdata('success')) {                        ?>                        <div class="alert alert-success">                            <strong>                                <?php                                echo $this->session->flashdata('success');                                ?>                            </strong>                        </div>                        <?php                    };					if ($this->session->flashdata('error')){						?>                        <div class="alert alert-error">                            <strong>                                <?php                                echo $this->session->flashdata('error');                                ?>                            </strong>                        </div>                        <?php					};										if (!empty($error)){						?>                        <div class="alert alert-error">                            <strong>                                 <?php                                echo $error;                                ?>                            </strong>                        </div>                        <?php					};										if (!empty($success)){						?>                        <div class="alert alert-success">                            <strong>                                <?php                                echo $success;                                ?>                            </strong>                        </div>                        <?php					};                   					echo validation_errors('<div class="alert alert-error"><h5>', '</h5></div>') ; 										?>					<div id="message"></div>					<table>						<tbody>							<tr>								<td>Kode Nota : <strong><?php echo $dtlTransfer[0]['kodeNota'] ?></strong></td>								<td style="padding-left:60px">Gudang Asal : <strong> <?php echo '('.$dtlTransfer[0]['AsalGudang'].') '.$dtlTransfer[0]['nmAsalGudang'] ?></strong></td>								<td style="padding-left:60px">Gudang Tujuan :<strong> <?php echo '('.$dtlTransfer[0]['tujuanGudang'].') '.$dtlTransfer[0]['namaGudangTjn'] ?> </strong></td>															<tr>						</tbody>					</table>										<table class="tablesorter" id="dtTransfer">						<thead>							<tr>								<th></th>								<th>Kode Barang</th>								<th>Nama Barang</th>								<th>Jml</th>								<th>Jml Diambil</th>								<th>Sisa</th>							</tr>						</thead>						<tfoot>							<tr>								<th></th>								<th>Kode Barang</th>								<th>Nama Barang</th>								<th>Jumlah</th>								<th>Jml Diambil</th>								<th>Sisa</th>							</tr>							<tr>								<th colspan="9" class="pager form-horizontal" style="text-align: center">									<button class="btn first"><i class="icon-step-backward"></i></button>									<button class="btn prev"><i class="icon-arrow-left"></i></button>									<span class="pagedisplay"></span> <!-- this can be any element, including an input -->									<button class="btn next"><i class="icon-arrow-right"></i></button>									<button class="btn last"><i class="icon-step-forward"></i></button>									<select class="pagesize input-mini" title="Select page size">										<option selected="selected" value="10">10</option>										<option value="20">20</option>										<option value="30">30</option>										<option value="40">40</option>									</select>									<select class="pagenum input-mini" title="Select page number"></select>								</th>							</tr>						</tfoot>						<tbody>							<?php 														$i = 0;								foreach ($dtlTransfer as $row) {																										?>									<tr>										<td width="50px"><input type="radio" name="kodeNota" value="<?php echo $row['brg'].'~'.$row['jml'].'~'.$row['AsalGudang'].'~'.$i ?>"> </td>										<td ><?php echo $row['brg'] ?></td>										<td ><?php echo $row['namaBarang'] ?></td>										<td ><?php echo $row['jmlKonv'] ?></td>										<td ><?php 												foreach ($konv as $sat){																									if ($sat[0]['barang'] == $row['brg']){														echo $sat[0]['QtyKonv'];													}												}										?>										</td>										<td> 											<?php 												foreach ($konvSisa as $sisa){													if ($sisa[0]['barang'] == $row['brg']){														echo $sisa[0]['QtyKonv'];													}												}											?>																														<div id="dialogform<?php echo $i; ?>" style="display:none" title="Barang : <?php echo $row['brg'] ?>">											<table class="table table-bordered table-hover table-striped table-condensed">												<thead>													<th>Rack Slot</th>													<th>Level</th>													<th>Exp Date</th>													<th>Qty</th>												</thead>												<tbody>												</tbody>											</table>											<span id="ajaxLoader<?php echo $i; ?>" style="display:none"><img src="<?php echo base_url() ?>files/css/ui-lightness/images/ajax-loader2.gif"></span>											<form method="POST" action="">													<input type="hidden" name="namaBarang" value="<?php echo $row['namaBarang'] ?>" >													<input type="hidden" name="kodeBarang" value="<?php echo $row['brg'] ?>" >													<input type="hidden" name="jml" value="<?php echo $row['jml']?>" >													<input type="hidden" name="jmlKonv" value="<?php echo $row['jmlKonv']?>" >													<input type="hidden" name="gudang" value="<?php echo $row['namaGudangTjn']?>" >													<input type="hidden" name="kodeGudangTjn" value="<?php echo $row['tujuanGudang']?>" >													<div id="ket<?php echo $i; ?>"></div>													<div id="status<?php echo $i; ?>">														<label>Jumlah : </label>														<input type="text" name="jmlInput" class="input-mini">														<span id="satuan<?php echo $i; ?>"></span>														<select name="satuan" class="input-small">															<?php foreach( $satuan as $as) {																	if ($as['brg'] == $row['brg'] ) :															?>																	<option value="<?php echo $as['Rasio'] ?>"> <?php echo $as['Satuan']?></option>															<?php 																	endif;																  }	 ?>														</select>														<input type="submit" name="btnAdd" class="btn btn-primary btn-small" value="Add" />													</div>											</form>										</div>										</td>									</tr>									<?php									$i++;								} 							?>						</tbody>					</table>					<br style="clear:both;" />										<table>						<thead>							<tr>								<th class="span1">No</th>								<th class="">Kode Barang</th>								<th class="">Nama Barang</th>								<th class="">Total</th>								<th class="">Jml Diambil</th>								<th class="">Gudang Tujuan</th>								<th class="">Rack Tujuan</th>								<th class=""></th>							</tr>						<thead>						<tbody>							<?php $i = 1; 														foreach ($this->cart->contents() as $barang) {							?>							<tr id="barang<?php echo $barang['rowid']?>">									<td style="text-align:center"><?php echo $i; ?></td>									<?php /*										foreach ($this->cart->product_options($barang['rowid']) as $nama => $value){																					?>													<td style="text-align:center"><?php echo $value ?></td>																						<?php }  */ //var_dump($barang);?>									<td style="text-align:center"><?php echo $barang['options']['kodeBarang'] ;?></td>									<td style="text-align:center"><?php echo $barang['options']['namaBarang'] ;?></td>									<td style="text-align:center"><?php echo $barang['options']['jmlKonv'] ;?></td>									<td style="text-align:center"><?php echo $barang['options']['jmlDiambil'] ;?></td>									<td style="text-align:center"><?php echo $barang['options']['gudang'] ;?></td>																			<?php if(empty($barang['options']['rackTujuan'])){ ?>										<td style="text-align:center">																							<a id="rackKosong" onclick="rackKosong('<?php echo $barang['rowid'] ?>')">Kosong</a>																					</td>									<?php }else{ ?>										  <td style="text-align:center">											<?php echo $barang['options']['rackTujuan'] ;?>																					</td>									<?php  }									?>																				<td style="text-align:center">											<button onclick="hapus(<?php echo "'".$barang['rowid']."'" ?>)" class="btn-small btn-info"><i class="icon-white icon-trash"></i></button>																				<div id="dialogform2<?php echo $barang['rowid']?>" style="display:none">											<table class="table table-bordered table-hover table-striped table-condensed">												<thead>													<th>Rack Slot</th>													<th>Level</th>													<th>Exp Date</th>													<th>Qty</th>												</thead>												<tbody>												</tbody>											</table>											<span id="ajaxLoader<?php echo $barang['rowid']?>" style="display:none"><img src="<?php echo base_url() ?>files/css/ui-lightness/images/ajax-loader2.gif"></span>											<div>												<input type="text" name="inputRack" id="cek<?php echo $barang['rowid']?>" onkeyup="fupper('<?php echo $barang['rowid']?>')" <?php /*onblur="ket('<?php echo $barang['rowid']?>')" */ ?>class="input-medium" placeholder="Masukan Nama Rack">																								<?php //<input type="text" name="DestRack" id="DestRack<?php echo $barang['rowid']" /> ?>												<input type="hidden" name="kodeBrg" id="kodeBrg<?php echo $barang['rowid']?>" value="<?php echo $barang['options']['kodeBarang'] ?>">												<button class="btn btn-primary btn-small" onclick="ubahRack(<?php echo "'".$barang['rowid']."'" ?>)">ganti</button>											</div>												</div>																	</td>								<?php $i++; ?>							</tr>							<?php } ?>						</tbody>					</table>										<input type="hidden" name="rowid" value="" id="rowid"/>					<button onclick="simpan()" class="btn btn-large">Simpan</button>					<p><p><a href="<?php echo base_url() ?>index.php/admin_replenish_gbs" class="btn btn-large btn-inverse">Kembali</a></p></p>					                </div><!-- /.span4 -->            </div><!-- /.row -->        </div><!-- /.container -->        <?php        $this->load->view("include/footer");        ?>        <script type="text/javascript">					var RackName=[				<?php				$i = 0;				foreach ($RackName as $row) {					echo '"' . $row['Name'] . '"';					if ($i < count($RackName) - 1) {						echo ',';					}				}				?>			];							<?php 					foreach($this->cart->contents() as $row){						?> 						$("#cek"+"<?php echo $row['rowid'] ?>").autocomplete({							// source: RackName,							source: function (request,response)							{								$.ajax({									url			:  "<?php echo base_url() ?>index.php/admin_replenish_gbs/get_name_rackSlot",									dataType 	: "json",									data		: {										dataPost : request.term									},									success	 : function (data)									{										response($.map(data, function(item){																					return {												label : item.name, // yang ditampilkan waktu di klik												value : item.name, // hasil yang di klik 												id	  : item.rackSlot												  											};										}));									}								});							},							minLength: 2,							select: function (event,ui){								// $(this).val(ui.item.id);								// $("#rowid").val(ui.item.id); // setelah di klik yang muncul mau di taruh di mana aj															},							open: function(event, ui) {								$(".ui-autocomplete").css("z-index", "2147483647");							}						});							<?php					}			 ?>						// $("#cek").show();			// $("#dialogform").hide();			// var ket;						// $("#cek"+$.session.get('sesRowId')).autocomplete({				// source: RackName			// });						// $.session.set('test','value');						// $.session.remove('sesRowId');								// alert($.session.get('sesRowId'));						function fupper(id){										// $("#cek"+id).keyup(function(){					$("#cek"+id).val($("#cek"+id).val().toUpperCase());				// });			}						// function ket(id){								// $("#cek"+id).blur(function(){				// var rack = $("#cek"+id).val();				// var postdata = {'RackName': rack};					// var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/get_name_rackSlot";					// $.ajax({						// type: 'POST',						// url: link,						// dataType: 'jsonp',						// data: postdata,						// jsonp: 'jsoncallback',						// timeout: 5000,						// success: function(data){							// if(data.status==true)							// {								// $("#DestRack"+id).val(data.RackSlotCode);							// }						// }						/*error: function (xhr, ajaxOptions, thrownError) {							alert(xhr.responseText);							alert(thrownError);						}						 error: function(){										alert(data,null,'Error','Ok');											alert('There is a problem',null,'Error','Ok');									}*/					// });				// });						// }										$('#dtTransfer tbody tr').click(            function() {                $('input[type=radio]',this).prop('checked', true);                var temp=$('input[type=radio]',this).val();                var arr = temp.split('~');				var brg=arr[0];                var jml=arr[1];                var gudang=arr[2];                var index=arr[3];                var postdata = {'brg':brg,'jml':jml,'gudang':gudang};                var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/get_ajax_suggestion";				$("#ajaxLoader"+index).show();				$("#status"+index).hide();                $.ajax({                    type: 'POST',                    url: link,                    dataType: 'jsonp',                    data: postdata,                    jsonp: 'jsoncallback',                    timeout: 5000,                    success: function(data){                        var str='';						var str2='';                        $.each(data, function(i,item){							// str+='<input type="text" name="status"';                            str+= '<tr>';                            str+= '<td>'+item['name']+'</td>';                            str+= '<td>'+item['rackLevel']+'</td>';                            str+= '<td>'+item['expDate']+'</td>';                            str+= '<td>'+item['qtyKonv']+'</td></tr>';							str2+= '<input type="hidden" name="binCode" value='+item['binCode']+'>';							str2+= '<input type="hidden" name="rackSlot" value='+item['rackSlot']+'>';							$("#status"+index).show();                        });						$("#ajaxLoader"+index).delay(2000).hide();						$("#ket"+index).html(str2);                        $("#dialogform"+index+" table tbody").html(str);                     }                    /*error: function (xhr, ajaxOptions, thrownError) {                                alert(xhr.responseText);                                alert(thrownError);                            }                            error: function(){                                    //alert(data,null,'Error','Ok');                                    alert('There is a problem',null,'Error','Ok');                            }*/					                });				$("#ajaxLoader"+index).fadeIn().delay(5000).fadeOut('slow');                 $( "#dialogform"+index ).dialog({					height: 250,                    width: 530,                    modal: true,                    open: function() {                        $('.ui-widget-overlay').bind('click', function() {                            $("#dialogform"+index).dialog('close');                        })                    }                });            });									function rackKosong(nilai){								var hdata = nilai;				var submit = {'rowId' : hdata };				var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/get_ajax_suggestion2";				$("#ajaxLoader"+hdata).show();				$("#cek"+hdata).hide();				$.ajax({					type: 'POST',                    url: link,                    dataType: 'jsonp',                    data: submit,                    jsonp: 'jsoncallback',                    timeout: 5000,					success: function(data){						// document.location = href;  // redirect browser to link						var str='';						if (data == ""){															$("#cek"+hdata).show();						}			           $.each(data, function(i,item){								                            str+= '<tr>';                            str+= '<td>'+item['name']+'</td>';                            str+= '<td>'+item['rackLevel']+'</td>';                            str+= '<td>'+item['expDate']+'</td>';                            str+= '<td>'+item['qtyKonv']+'</td></tr>';							str+= '<input type="hidden" name="rackSlot" id="rackSlot" value='+item['name']+'>';							str+= '<input type="hidden" name="rackCode" id="rackCode" value='+item['rackSlot']+'>';														                        });				        $("#dialogform2"+hdata+" table tbody").html(str);                        $("#rowid").val(hdata);					}				});				$("#ajaxLoader"+hdata).fadeIn().delay(2000).fadeOut('slow'); 			    $( "#dialogform2"+hdata ).dialog({ 					height: 230,					width: 400,					modal: true});			};						function ubahRack(rowid) {				var rackSlot = $("#rackSlot").val();				var rackCode = $("#rackCode").val();				var inputCek = $("#cek"+rowid).val();				var kodeBrg	 = $("#kodeBrg"+rowid).val();				var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/ubahRack";				var submit = {'rowid' : rowid, 'rackSlot' :rackSlot, 'rackCode' : rackCode, 'inputCek' : inputCek, 'kodeBrg' : kodeBrg }								$.ajax({					url: link,					type:"post",					datatype:'json',					data:submit,					success: function(data) {						if(data.status){							window.location.assign(location.href);							// window.location.replace("<?php echo base_url() ?>index.php/admin_replenish_gbs/entry_detail");												}else {							$( "#dialogform2"+rowid ).dialog('close');							$("#message").html(data.error);						}											}				});							}						function simpan() {				var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/simpan";				$.ajax({					type: 'POST',					url : link,					dataType:'json',					// data:submit,					// jsonp : 'jsoncallback',					success: function(data){						if(data.status){							// var msg = "<div class='alert alert-success'><h5>Data berhasil ditambahkan.</h5></div>";							// $("#message").html(msg);							window.location.replace("<?php echo base_url() ?>index.php/admin_replenish_gbs");												}else {								$("#message").html(data.error);						}					}                        // output.html(str);				});			}						function hapus(rowid) {				var postdata = {'rowId':rowid}				var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/hapus_brg";				$.ajax({					type: 'POST',                    url: link,                    dataType: 'jsonp',                    data: postdata,                    jsonp: 'jsoncallback',                    timeout: 5000,                    success: function(data){						// $('#barang'+rowid).remove();                        var str='';                        $.each(data, function(i,item){                                                      // str+= item['success']+'<strong> Data Berhasil Di Hapus </strong>';                                                   });                        // $("#success").html(str);						window.location.assign(location.href);						// $("#dtTransfer").load('<?php echo base_url() . "index.php/admin_replenish_gbs/entry_detail" ?>');						// if (!data.error) location.reload(true);                    }                                    });				            };									// function detectChange(input, interval) {                // var previous = "";				                // setInterval( function() {				// var hdata = ($("#rowid").val());					// $.session.set('sesRowId',hdata);                    // var val = $("#sum").val();					// alert(val);                    // if (  val != previous ) {                        // previous = val;						// var val = $("#sum").val();						// var arr = val.split('~');						// var brg=arr[0];						// var sum=arr[1];						// var index=arr[2];						// alert(sum)                        // var postdata = {'brg':brg,'sum':sum};                        // var link = "<?php echo base_url() ?>index.php/admin_replenish_gbs/get_satuan";                        // $.ajax({                            // type: 'POST',                            // url: link,                            // dataType: 'jsonp',                            // data: postdata,                            // jsonp: 'jsoncallback',                            // timeout: 5000,                            // success: function(data){                                // var str='';                                 // var str='<select name="ratio" class="input-small" id="rasio">';                                // $.each(data, function(i,item){                                    // str = str +'<option value="'+item["qty"]+'"';                                                                                                            // str+='>'+item["qty"]+'</option>';                                // });                                // str+='</select>';                                // SKUCodelama=SKUCode;                                // $("#jmlDiambil"+index).html(str);                                    // },                            // /*error: function (xhr, ajaxOptions, thrownError) {                                // alert(xhr.responseText);                                // alert(thrownError);                            // }                            // error: function(){                                // $("#jmlDiambil"+index).html('');                              // }							// */                        // });                                               // }                // }, interval);            // }            // detectChange(10);		            $(function() {                $.extend($.tablesorter.themes.bootstrap, {                    // these classes are added to the table. To see other table classes available,                    // look here: http://twitter.github.com/bootstrap/base-css.html#tables                    table      : 'table table-bordered',                    header     : 'bootstrap-header', // give the header a gradient background                    footerRow  : '',                    footerCells: '',                    icons      : '', // add "icon-white" to make them white; this icon class is added to the <i> in the header                    sortNone   : 'bootstrap-icon-unsorted',                    sortAsc    : 'icon-chevron-up',                    sortDesc   : 'icon-chevron-down',                    active     : '', // applied when column is sorted                    hover      : '', // use custom css here - bootstrap class may not override it                    filterRow  : '', // filter row class                    even       : '', // odd row zebra striping                    odd        : ''  // even row zebra striping                });                // call the tablesorter plugin and apply the uitheme widget                $("table").tablesorter({                    theme : "bootstrap", // this will                     widthFixed: true,                    headerTemplate : '{content} {icon}', // new in v2.7. Needed to add the bootstrap icon!                    // widget code contained in the jquery.tablesorter.widgets.js file                    // use the zebra stripe widget if you plan on hiding any rows (filter widget)                    widgets : [ "uitheme", "filter", "zebra" ],                    headers: {                        // 4: { sorter: false }                    },                    widgetOptions : {                        // using the default zebra striping class name, so it actually isn't included in the theme variable above                        // this is ONLY needed for bootstrap theming if you are using the filter widget, because rows are hidden                        zebra : ["even", "odd"],                        // reset filters button                        filter_reset : ".reset",                        filter_formatter : {                            // 4 : function(){return false;}                        }                        // set the uitheme widget to use the bootstrap theme class names                        // uitheme : "bootstrap"                    }                })                .tablesorterPager({                    // target the pager markup - see the HTML block below                    container: $(".pager"),                    // target the pager page select dropdown - choose a page                    cssGoto  : ".pagenum",                    // remove rows from the table to speed up the sort of large tables.                    // setting this to false, only hides the non-visible rows; needed if you plan to add/remove rows with the pager enabled.                    removeRows: false,                    // output string - default is '{page}/{totalPages}';                    // possible variables: {page}, {totalPages}, {filteredPages}, {startRow}, {endRow}, {filteredRows} and {totalRows}                    output: '{startRow} - {endRow} / {filteredRows} ({totalRows})'                });            });        </script>			<script src="<?php echo base_url() ?>files/js/jquery-ui-1.10.3.custom.min.js"></script>    </body></html>